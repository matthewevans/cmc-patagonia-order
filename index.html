<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CMC EM Patagonia Order Form 2026</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,600;0,700&family=Source+Serif+4:wght@600;700&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #f5f0eb;
    --surface: #ffffff;
    --border: #d4cdc4;
    --border-focus: #009CA6;
    --text: #1a1a1a;
    --text-muted: #6b6560;
    --accent: #009CA6;          /* Pantone 321C */
    --accent-hover: #007A82;
    --danger: #b5403a;
    --danger-hover: #943330;
    --tag-bg: #e8e2da;
    --radius: 8px;
    --font-body: 'DM Sans', sans-serif;
    --font-heading: 'Source Serif 4', Georgia, serif;
  }

  html { font-size: 16px; }

  body {
    font-family: var(--font-body);
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
  }

  .page-wrapper {
    max-width: 740px;
    margin: 0 auto;
    padding: 2rem 1.25rem 4rem;
  }

  /* ── Header ── */
  .page-header {
    text-align: center;
    margin-bottom: 2.5rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid var(--border);
  }

  .page-header h1 {
    font-family: var(--font-heading);
    font-size: 1.85rem;
    font-weight: 700;
    letter-spacing: -0.02em;
    margin-bottom: 0.35rem;
  }

  .page-header .subtitle {
    color: var(--text-muted);
    font-size: 0.95rem;
  }

  /* ── Sections ── */
  .form-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 1.75rem;
    margin-bottom: 1.25rem;
  }

  .form-section h2 {
    font-family: var(--font-heading);
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1.25rem;
  }

  /* ── Form controls ── */
  .field { margin-bottom: 1rem; }
  .field:last-child { margin-bottom: 0; }

  .field label {
    display: block;
    font-size: 0.85rem;
    font-weight: 600;
    margin-bottom: 0.3rem;
    color: var(--text);
  }

  .field label .req { color: var(--danger); margin-left: 2px; }

  .field-hint {
    font-size: 0.78rem;
    color: var(--text-muted);
    margin-bottom: 0.3rem;
    font-style: italic;
  }

  input[type="text"],
  input[type="tel"],
  input[type="email"],
  select {
    width: 100%;
    padding: 0.55rem 0.75rem;
    font-family: var(--font-body);
    font-size: 0.9rem;
    border: 1px solid var(--border);
    border-radius: 6px;
    background: #fff;
    color: var(--text);
    transition: border-color 0.15s;
    appearance: none;
    -webkit-appearance: none;
  }

  select {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath d='M2 4l4 4 4-4' fill='none' stroke='%236b6560' stroke-width='1.5' stroke-linecap='round'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    padding-right: 2.25rem;
  }

  input:focus, select:focus {
    outline: none;
    border-color: var(--border-focus);
    box-shadow: 0 0 0 3px rgba(0, 156, 166, 0.1);
  }

  .row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
  .row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 0.75rem; }

  @media (max-width: 520px) {
    .row-2, .row-3 { grid-template-columns: 1fr; }
  }

  /* ── Item cards ── */
  .item-card {
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 1.25rem;
    margin-bottom: 1rem;
    position: relative;
    background: #fafaf8;
  }

  .item-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
  }

  .item-card-header h3 {
    font-size: 0.95rem;
    font-weight: 600;
  }

  .btn-remove {
    background: none;
    border: 1px solid var(--danger);
    color: var(--danger);
    font-family: var(--font-body);
    font-size: 0.78rem;
    font-weight: 600;
    padding: 0.3rem 0.65rem;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.15s;
  }

  .btn-remove:hover { background: var(--danger); color: #fff; }

  /* ── Buttons ── */
  .btn-add {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    background: none;
    border: 1px dashed var(--accent);
    color: var(--accent);
    font-family: var(--font-body);
    font-size: 0.88rem;
    font-weight: 600;
    padding: 0.6rem 1.1rem;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.15s;
    margin-top: 0.5rem;
  }

  .btn-add:hover { background: rgba(0,156,166,0.06); }

  .btn-submit {
    display: block;
    width: 100%;
    padding: 0.85rem;
    font-family: var(--font-body);
    font-size: 1rem;
    font-weight: 600;
    color: #fff;
    background: var(--accent);
    border: none;
    border-radius: var(--radius);
    cursor: pointer;
    transition: background 0.15s;
  }

  .btn-submit:hover { background: var(--accent-hover); }
  .btn-submit:disabled { opacity: 0.55; cursor: not-allowed; }

  /* ── FAQ ── */
  .faq-section { margin-bottom: 1.25rem; }

  .faq-section details {
    border-bottom: 1px solid var(--border);
    padding: 0.85rem 0;
  }

  .faq-section details:last-child { border-bottom: none; }

  .faq-section summary {
    font-weight: 600;
    font-size: 0.88rem;
    cursor: pointer;
    list-style: none;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .faq-section summary::-webkit-details-marker { display: none; }

  .faq-section summary::after {
    content: '+';
    font-size: 1.1rem;
    font-weight: 400;
    color: var(--text-muted);
    transition: transform 0.2s;
  }

  .faq-section details[open] summary::after {
    content: '−';
  }

  .faq-answer {
    margin-top: 0.65rem;
    font-size: 0.85rem;
    color: var(--text-muted);
    line-height: 1.65;
  }

  .faq-answer table {
    width: 100%;
    border-collapse: collapse;
    margin: 0.5rem 0;
    font-size: 0.82rem;
  }

  .faq-answer th, .faq-answer td {
    text-align: left;
    padding: 0.35rem 0.65rem;
    border: 1px solid var(--border);
  }

  .faq-answer th {
    background: var(--tag-bg);
    font-weight: 600;
    color: var(--text);
  }

  /* ── Feedback ── */
  .toast {
    position: fixed;
    bottom: 1.5rem;
    left: 50%;
    transform: translateX(-50%) translateY(1rem);
    background: var(--accent);
    color: #fff;
    padding: 0.85rem 1.5rem;
    border-radius: var(--radius);
    font-size: 0.9rem;
    font-weight: 500;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s ease;
    z-index: 100;
    text-align: center;
    max-width: 90vw;
  }

  .toast.error { background: var(--danger); }
  .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); pointer-events: auto; }

  .field.invalid input,
  .field.invalid select {
    border-color: var(--danger);
    box-shadow: 0 0 0 3px rgba(181,64,58,0.1);
  }
</style>
</head>
<body>

<div class="page-wrapper">
  <header class="page-header">
    <h1>CMC EM Patagonia Order 2026</h1>
    <p class="subtitle">Better Sweater® Collection — Custom Embroidered</p>
  </header>

  <!-- FAQ -->
  <section class="form-section faq-section">
    <h2>Frequently Asked Questions</h2>

    <details>
      <summary>How much do the items cost?</summary>
      <div class="faq-answer">
        Pricing depends on total order volume. Below are the per-unit rates at various quantity tiers:
        <table>
          <tr><th>Product</th><th>6 pcs</th><th>18 pcs</th><th>50 pcs</th><th>72 pcs</th></tr>
          <tr><td>Jacket (Full Zip)</td><td>$175</td><td>$173.58</td><td>$162.68</td><td>$159.68</td></tr>
          <tr><td>Quarter Zip</td><td>$155</td><td>$152</td><td>$142.68</td><td>$139.58</td></tr>
          <tr><td>Vest</td><td>$132.88</td><td>$131.28</td><td>$123.58</td><td>$119.88</td></tr>
        </table>
        Final pricing will be communicated once all orders are in.
      </div>
    </details>

    <details>
      <summary>How much does name embroidery cost?</summary>
      <div class="faq-answer">
        Pricing for name embroidery will be confirmed once orders close. An additional fee will be added per item that includes a name/title.
      </div>
    </details>

    <details>
      <summary>How do I send payment?</summary>
      <div class="faq-answer">
        Once all orders are received, you will be emailed an invoice with your total and payment instructions.
      </div>
    </details>

    <details>
      <summary>How do I pick up my order?</summary>
      <div class="faq-answer">
        Orders will be shipped to the 3rd Floor MEB building at CMC Main. You will be responsible for picking up your individual order. The exact pickup location will be sent via email once the order arrives.
      </div>
    </details>

    <details>
      <summary>What is the return/refund policy?</summary>
      <div class="faq-answer">
        There are no returns on embroidered items. Refunds are only issued for quality control issues deemed to be the vendor's fault. Please double-check your size and that your name/title is typed exactly as you want it embroidered.
      </div>
    </details>
  </section>

  <!-- Form -->
  <form id="orderForm" novalidate>

    <!-- Personal info -->
    <section class="form-section">
      <h2>Your Information</h2>
      <div class="field">
        <label>Full Name <span class="req">*</span></label>
        <input type="text" id="personName" required>
      </div>
      <div class="row-2">
        <div class="field">
          <label>Phone <span class="req">*</span></label>
          <input type="tel" id="personPhone" required>
        </div>
        <div class="field">
          <label>Email <span class="req">*</span></label>
          <input type="email" id="personEmail" required>
        </div>
      </div>
      <div class="field">
        <label>Position / Occupation <span class="req">*</span></label>
        <select id="personPosition" required>
          <option value="">Select…</option>
          <option>Attending</option>
          <option>Fellow</option>
          <option>Resident</option>
          <option>APP</option>
          <option>Nurse</option>
          <option>Tech</option>
          <option>EMS</option>
          <option>Administrative Faculty</option>
        </select>
      </div>
    </section>

    <!-- Items -->
    <section class="form-section">
      <h2>Items</h2>
      <div id="itemsContainer"></div>
      <button type="button" class="btn-add" id="addItemBtn">+ Add another item</button>
    </section>

    <button type="submit" class="btn-submit" id="submitBtn">Submit Order</button>
  </form>
</div>

<div class="toast" id="toast"></div>

<script>
// ─── CONFIG ───────────────────────────────────────────────────────────────────
// Replace this with your deployed Google Apps Script web app URL
const APPS_SCRIPT_URL = "";
// ──────────────────────────────────────────────────────────────────────────────

const COLORS = {
  mens: [
    { value: "Black", label: "Black" },
    { value: "New Navy", label: "New Navy" },
    { value: "Stonewash", label: "Stonewash (Heather Gray)" },
  ],
  womens: [
    { value: "Black", label: "Black" },
    { value: "New Navy", label: "New Navy" },
    { value: "Birch White", label: "Birch White (Heather Gray)" },
    { value: "Dark Ruby", label: "Dark Ruby (Maroon)" },
  ],
};

const LOGOS = [
  { value: "Option 1", label: "Original CMC Logo (Solid Teal)" },
  { value: "Option 2", label: "Original CMC Logo (Solid White)" },
  { value: "Option 3", label: "Skyline Logo (Teal and White)" },
];

const THREAD_COLORS = [
  { value: "Black", label: "Black" },
  { value: "White", label: "White" },
];

let itemCount = 0;

function createItemCard() {
  itemCount++;
  const id = itemCount;
  const card = document.createElement("div");
  card.className = "item-card";
  card.dataset.id = id;

  card.innerHTML = `
    <div class="item-card-header">
      <h3>Item ${id}</h3>
      ${id > 1 ? `<button type="button" class="btn-remove" onclick="removeItem(this)">Remove</button>` : ""}
    </div>
    <div class="row-2">
      <div class="field">
        <label>Product <span class="req">*</span></label>
        <select data-field="product" required>
          <option value="">Select…</option>
          <option value="Better Sweater Jacket">Better Sweater® Jacket (Full Zip)</option>
          <option value="Better Sweater Vest">Better Sweater® Vest</option>
          <option value="Better Sweater Quarter Zip">Better Sweater® Quarter Zip</option>
        </select>
      </div>
      <div class="field">
        <label>Style <span class="req">*</span></label>
        <select data-field="style" required onchange="updateColors(this)">
          <option value="">Select…</option>
          <option value="Mens">Men's</option>
          <option value="Womens">Women's</option>
        </select>
      </div>
    </div>
    <div class="row-3">
      <div class="field">
        <label>Size <span class="req">*</span></label>
        <select data-field="size" required>
          <option value="">Select…</option>
          <option>XXS</option><option>XS</option><option>S</option>
          <option>M</option><option>L</option><option>XL</option><option>XXL</option>
        </select>
      </div>
      <div class="field">
        <label>Color <span class="req">*</span></label>
        <select data-field="color" required>
          <option value="">Select style first…</option>
        </select>
      </div>
      <div class="field">
        <label>Logo <span class="req">*</span></label>
        <select data-field="logo" required>
          <option value="">Select…</option>
          ${LOGOS.map((l) => `<option value="${l.value}">${l.label}</option>`).join("")}
        </select>
      </div>
    </div>
    <div class="row-2">
      <div class="field">
        <label>Embroidered Name &amp; Title</label>
        <div class="field-hint">Optional — e.g. "Jane Doe, MD"</div>
        <input type="text" data-field="embroideredName" placeholder="Jane Doe, MD">
      </div>
      <div class="field">
        <label>Name Thread Color</label>
        <div class="field-hint">Required if name entered</div>
        <select data-field="threadColor">
          <option value="">Select…</option>
          ${THREAD_COLORS.map((t) => `<option value="${t.value}">${t.label}</option>`).join("")}
        </select>
      </div>
    </div>
  `;

  document.getElementById("itemsContainer").appendChild(card);
  renumberItems();
}

function removeItem(btn) {
  btn.closest(".item-card").remove();
  renumberItems();
}

function renumberItems() {
  document.querySelectorAll(".item-card").forEach((card, i) => {
    card.querySelector("h3").textContent = `Item ${i + 1}`;
  });
}

function updateColors(styleSelect) {
  const card = styleSelect.closest(".item-card");
  const colorSelect = card.querySelector('[data-field="color"]');
  const style = styleSelect.value;

  colorSelect.innerHTML = '<option value="">Select…</option>';

  if (style && COLORS[style.toLowerCase()]) {
    COLORS[style.toLowerCase()].forEach((c) => {
      const opt = document.createElement("option");
      opt.value = c.value;
      opt.textContent = c.label;
      colorSelect.appendChild(opt);
    });
  }
}

function showToast(message, isError) {
  const toast = document.getElementById("toast");
  toast.textContent = message;
  toast.className = "toast" + (isError ? " error" : "") + " show";
  setTimeout(() => (toast.className = "toast"), 4000);
}

function validate() {
  let valid = true;

  // Clear previous
  document.querySelectorAll(".field.invalid").forEach((f) => f.classList.remove("invalid"));

  // Person fields
  ["personName", "personPhone", "personEmail", "personPosition"].forEach((id) => {
    const el = document.getElementById(id);
    if (!el.value.trim()) {
      el.closest(".field").classList.add("invalid");
      valid = false;
    }
  });

  // Items
  const cards = document.querySelectorAll(".item-card");
  if (cards.length === 0) {
    showToast("Add at least one item.", true);
    return false;
  }

  cards.forEach((card) => {
    ["product", "style", "size", "color", "logo"].forEach((f) => {
      const el = card.querySelector(`[data-field="${f}"]`);
      if (!el.value) {
        el.closest(".field").classList.add("invalid");
        valid = false;
      }
    });

    // If name entered, thread color required
    const nameVal = card.querySelector('[data-field="embroideredName"]').value.trim();
    const threadVal = card.querySelector('[data-field="threadColor"]').value;
    if (nameVal && !threadVal) {
      card.querySelector('[data-field="threadColor"]').closest(".field").classList.add("invalid");
      valid = false;
    }
  });

  if (!valid) showToast("Please fill in all required fields.", true);
  return valid;
}

document.getElementById("orderForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  if (!validate()) return;

  if (!APPS_SCRIPT_URL) {
    showToast("Form endpoint not configured yet.", true);
    return;
  }

  const btn = document.getElementById("submitBtn");
  btn.disabled = true;
  btn.textContent = "Submitting…";

  const items = [];
  document.querySelectorAll(".item-card").forEach((card) => {
    items.push({
      product: card.querySelector('[data-field="product"]').value,
      style: card.querySelector('[data-field="style"]').value,
      size: card.querySelector('[data-field="size"]').value,
      color: card.querySelector('[data-field="color"]').value,
      logo: card.querySelector('[data-field="logo"]').value,
      embroideredName: card.querySelector('[data-field="embroideredName"]').value.trim(),
      threadColor: card.querySelector('[data-field="threadColor"]').value,
    });
  });

  const payload = {
    name: document.getElementById("personName").value.trim(),
    phone: document.getElementById("personPhone").value.trim(),
    email: document.getElementById("personEmail").value.trim(),
    position: document.getElementById("personPosition").value,
    items,
  };

  try {
    const res = await fetch(APPS_SCRIPT_URL, {
      method: "POST",
      body: JSON.stringify(payload),
      headers: { "Content-Type": "text/plain" }, // avoid CORS preflight
    });

    const result = await res.json();

    if (result.status === "ok") {
      showToast(`Order submitted! ${items.length} item(s) recorded.`);
      document.getElementById("orderForm").reset();
      document.getElementById("itemsContainer").innerHTML = "";
      itemCount = 0;
      createItemCard();
    } else {
      throw new Error(result.message || "Unknown error");
    }
  } catch (err) {
    showToast("Submission failed — please try again. " + err.message, true);
  } finally {
    btn.disabled = false;
    btn.textContent = "Submit Order";
  }
});

// Add first item on load
document.getElementById("addItemBtn").addEventListener("click", createItemCard);
createItemCard();
</script>

</body>
</html>
